#!/bin/bash

if [ ! -n "$1" ]; then
    echo "Oops! Pass a name.";
    exit 1;
fi

set -e

mkdir -p .git-multi

unset GIT_WORK_TREE

for name in "$@"
do
	git init --bare ".git-multi/${name}"

	git config -f ".git-multi/${name}/config" core.bare false
	git config -f ".git-multi/${name}/config" core.worktree "../../"

	mkdir -p ".git-multi/${name}/info"

	echo ".git-multi/" >> .git-multi/${1}/info/exclude
done
